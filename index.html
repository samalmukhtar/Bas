
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مثلث باسكال العجيب - النسخة المتطورة مع الاستنطاق</title>
    <style>
        :root {
            --primary-color: #4a148c;
            --secondary-color: #7b1fa2;
            --accent-color: #e1bee7;
            --text-color: #212121;
            --background-color: #f5f5f5;
            --hexagon-color: #e1f5fe;
            --hexagon-border: #7b1fa2;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            gap: 30px;
        }
        
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .exploded-panel {
                order: 3;
            }
        }
        
        .controls {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .control-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        
        input[type="range"] {
            width: 100%;
        }
        
        .range-value {
            display: inline-block;
            width: 50px;
            text-align: center;
            margin-left: 10px;
        }
        
        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        button:hover {
            background-color: var(--secondary-color);
        }
        
        .canvas-container {
            position: relative;
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            min-height: 500px;
        }
        
        canvas {
            display: block;
            width: 100%;
            height: 100%;
        }
        
        .exploded-panel {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            max-height: 600px;
            overflow-y: auto;
        }
        
        .exploded-item {
            background-color: var(--accent-color);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        
        .exploded-title {
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .exploded-content {
            font-family: 'Courier New', monospace;
        }
        
        .info-panel {
            grid-column: 1 / -1;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            margin-top: 20px;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
        }
        
        .tab.active {
            border-bottom: 3px solid var(--primary-color);
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .formulas {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
        }
        
        .formula-card {
            background-color: var(--accent-color);
            padding: 15px;
            border-radius: 8px;
        }
        
        .formula-title {
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .formula-content {
            font-family: 'Courier New', monospace;
        }
        
        .color-schemes {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .color-scheme {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
        }
        
        .color-scheme.active {
            border-color: #333;
        }
        
        .display-styles {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .display-style {
            padding: 8px 15px;
            background-color: #eee;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .display-style.active {
            background-color: var(--primary-color);
            color: white;
        }
        
        .history-controls {
            margin-top: 15px;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #666;
            font-size: 0.9rem;
        }
        
        .status-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px 10px;
            font-size: 0.9rem;
        }
        
        .exploded-number {
            font-weight: bold;
            font-size: 1.2rem;
            color: var(--primary-color);
        }
        
        .close-btn {
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            font-size: 1.2rem;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .theory-section {
            margin-bottom: 30px;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 8px;
            border-right: 4px solid var(--primary-color);
        }
        
        .theory-title {
            font-size: 1.3rem;
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        
        .theory-content {
            line-height: 1.8;
        }
        
        .theory-formula {
            background-color: #e8eaf6;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            direction: ltr;
            text-align: center;
        }
        
        .theory-example {
            background-color: #e0f2f1;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        .highlight {
            background-color: #fff9c4;
            padding: 2px 5px;
            border-radius: 3px;
        }
        
        .data-types {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .data-type {
            padding: 8px 15px;
            background-color: #eee;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .data-type.active {
            background-color: var(--primary-color);
            color: white;
        }
        
        .cell-content {
            text-align: center;
            line-height: 1.3;
        }
        
        .cell-name {
            font-weight: bold;
            font-size: 0.8rem;
        }
        
        .cell-details {
            font-size: 0.7rem;
            color: #555;
        }
        
        .cell-number {
            font-size: 0.9rem;
            font-weight: bold;
            margin-top: 2px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>مثلث باسكال العجيب - النسخة المتطورة مع الاستنطاق</h1>
            <p class="subtitle">تطبيق تفاعلي شامل مع استنطاق الحروف، السور القرآنية، أسماء الله الحسنى، والرسل والفراعنة</p>
        </header>
        
        <div class="main-content">
            <div class="controls">
                <div class="control-group">
                    <label for="layers">عدد طبقات المثلث: <span id="layers-value" class="range-value">5</span></label>
                    <input type="range" id="layers" min="1" max="111" value="5">
                </div>
                
                <div class="control-group">
                    <label for="rotation">درجة التدوير: <span id="rotation-value" class="range-value">0</span></label>
                    <input type="range" id="rotation" min="0" max="2300" value="0">
                </div>
                
                <div class="control-group">
                    <label for="zoom">مستوى التكبير: <span id="zoom-value" class="range-value">1.0</span></label>
                    <input type="range" id="zoom" min="0.1" max="3" step="0.1" value="1.0">
                </div>
                
                <div class="control-group">
                    <label>نمط العرض:</label>
                    <div class="display-styles">
                        <div class="display-style active" data-style="hexagon">خلية النحل</div>
                        <div class="display-style" data-style="triangle">مثلث تقليدي</div>
                        <div class="display-style" data-style="circle">دوائر</div>
                        <div class="display-style" data-style="square">مربعات</div>
                    </div>
                </div>
                
                <div class="control-group">
                    <label>نوع البيانات:</label>
                    <div class="data-types">
                        <div class="data-type active" data-type="numbers">أرقام باسكال</div>
                        <div class="data-type" data-type="suras">السور القرآنية</div>
                        <div class="data-type" data-type="allahNames">أسماء الله الحسنى</div>
                        <div class="data-type" data-type="prophets">الرسل والأنبياء</div>
                        <div class="data-type" data-type="pharaohs">الفراعنة</div>
                        <div class="data-type" data-type="abjad">حساب الجمل</div>
                    </div>
                </div>
                
                <div class="control-group">
                    <label>نظام الألوان:</label>
                    <div class="color-schemes">
                        <div class="color-scheme active" style="background: linear-gradient(135deg, #4a148c, #7b1fa2);" data-scheme="default"></div>
                        <div class="color-scheme" style="background: linear-gradient(135deg, #00695c, #004d40);" data-scheme="green"></div>
                        <div class="color-scheme" style="background: linear-gradient(135deg, #b71c1c, #c62828);" data-scheme="red"></div>
                        <div class="color-scheme" style="background: linear-gradient(135deg, #0d47a1, #1565c0);" data-scheme="blue"></div>
                        <div class="color-scheme" style="background: linear-gradient(135deg, #4a148c, #6a1b9a);" data-scheme="purple"></div>
                    </div>
                </div>
                
                <div class="control-group">
                    <button id="reset-view">إعادة ضبط العرض</button>
                    <button id="calculate">حساب المعادلات</button>
                    <button id="reset-triangle">إعادة تعيين المثلث</button>
                </div>
                
                <div class="control-group history-controls">
                    <button id="undo-btn" disabled>تراجع (زر الماوس الأيمن)</button>
                    <p style="margin-top: 10px; font-size: 0.9rem;">للتفكيك: اضغط Ctrl + زر الماوس الأيسر على أي مثلث</p>
                </div>
                
                <div class="control-group">
                    <h3>خصائص المثلث</h3>
                    <p id="triangle-properties">سيتم عرض خصائص المثلث هنا بعد الحساب</p>
                </div>
            </div>
            
            <div class="canvas-container">
                <canvas id="pascalCanvas"></canvas>
                <div class="status-bar" id="status-bar">جاهز - اضغط Ctrl + زر الماوس الأيسر لتفكيك المثلثات</div>
            </div>
            
            <div class="exploded-panel">
                <h3>الخلايا المفككة وشرحها</h3>
                <div id="exploded-container">
                    <!-- سيتم ملؤها ديناميكياً -->
                </div>
            </div>
            
            <div class="info-panel">
                <div class="tabs">
                    <div class="tab active" data-tab="formulas">المعادلات المستخرجة</div>
                    <div class="tab" data-tab="analysis">التحليل النظري والهندسي</div>
                    <div class="tab" data-tab="theories">النظريات الرياضية</div>
                    <div class="tab" data-tab="magic">الطلسم والأسرار</div>
                    <div class="tab" data-tab="scientists">معادلات العلماء</div>
                    <div class="tab" data-tab="abjad-tab">حساب الجمل والاستنطاق</div>
                </div>
                
                <div class="tab-content active" id="formulas-tab">
                    <div class="formulas" id="formulas-container">
                        <!-- سيتم ملؤها ديناميكياً -->
                    </div>
                </div>
                
                <div class="tab-content" id="analysis-tab">
                    <h3>التحليل النظري والهندسي</h3>
                    <p>مثلث باسكال هو ترتيب هندسي للأعداد يتبع قاعدة رياضية بسيطة حيث كل عدد هو مجموع العددين الموجودين فوقه مباشرة.</p>
                    <p>في الشكل السداسي، يمكن ملاحظة العديد من الخصائص الهندسية المثيرة:</p>
                    <ul>
                        <li>تناظر محوري حول المحور الرأسي</li>
                        <li>تتابع فيبوناتشي يمكن استخراجه من الأقطار</li>
                        <li>معاملات ذات الحدين (a+b)^n</li>
                        <li>أعداد مثلثية ومربعة ومكعبة</li>
                        <li>تطبيقات في نظرية الاحتمالات والإحصاء</li>
                    </ul>
                    <p>يمكن استخدام هذه الخصائص في حل مسائل التوافقيات ونظرية الأعداد والجبر.</p>
                </div>
                
                <div class="tab-content" id="theories-tab">
                    <div class="theory-section">
                        <div class="theory-title">متسلسلة فيبوناتشي ومثلث باسكال</div>
                        <div class="theory-content">
                            <p>متسلسلة فيبوناتشي هي متتالية عددية تبدأ بـ 0 و 1، وكل عدد لاحق هو مجموع العددين السابقين له:</p>
                            <div class="theory-formula">0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, ...</div>
                            <p>يمكن استخراج متسلسلة فيبوناتشي من مثلث باسكال عن طريق جمع الأعداد على الأقطار المائلة:</p>
                            <div class="theory-example">
                                <p>لاحظ أن الأعداد على الأقطار المائلة في مثلث باسكال تشكل متسلسلة فيبوناتشي:</p>
                                <p>القطر الأول: 1 = 1</p>
                                <p>القطر الثاني: 1 = 1</p>
                                <p>القطر الثالث: 1+1 = 2</p>
                                <p>القطر الرابع: 1+2 = 3</p>
                                <p>القطر الخامس: 1+3+1 = 5</p>
                                <p>القطر السادس: 1+4+3 = 8</p>
                                <p>وهكذا...</p>
                            </div>
                            <p>هذه العلاقة تعكس الارتباط العميق بين التوافقيات ومتسلسلة فيبوناتشي.</p>
                        </div>
                    </div>
                    
                    <div class="theory-section">
                        <div class="theory-title">الأعداد المثلثية والمربعة</div>
                        <div class="theory-content">
                            <p>يمكن استخراج الأعداد المثلثية من العمود الثاني في مثلث باسكال:</p>
                            <div class="theory-formula">1, 3, 6, 10, 15, 21, 28, 36, 45, 55, ...</div>
                            <p>هذه الأعداد تمثل عدد النقاط في مثلث متساوي الأضلاع.</p>
                            <p>الأعداد المربعة يمكن استخراجها من مجموع عددين مثلثين متتاليين:</p>
                            <div class="theory-formula">1+3=4, 3+6=9, 6+10=16, 10+15=25, ...</div>
                            <p>هذه العلاقات توضح كيف يمكن لمثلث باسكال أن يربط بين أنواع مختلفة من المتتاليات العددية.</p>
                        </div>
                    </div>
                    
                    <div class="theory-section">
                        <div class="theory-title">معاملات ذات الحدين</div>
                        <div class="theory-content">
                            <p>مثلث باسكال يمثل معاملات ذات الحدين في نظرية ذات الحدين:</p>
                            <div class="theory-formula">(a+b)^n = C(n,0)a^n + C(n,1)a^(n-1)b + ... + C(n,n)b^n</div>
                            <p>حيث C(n,k) هي معاملات ذات الحدين الموجودة في مثلث باسكال.</p>
                            <p>على سبيل المثال، لـ n=4:</p>
                            <div class="theory-formula">(a+b)^4 = 1a^4 + 4a^3b + 6a^2b^2 + 4ab^3 + 1b^4</div>
                            <p>الأعداد 1, 4, 6, 4, 1 هي الصف الرابع في مثلث باسكال.</p>
                        </div>
                    </div>
                    
                    <div class="theory-section">
                        <div class="theory-title">النظرية التوافقية</div>
                        <div class="theory-content">
                            <p>يمثل مثلث باسكال عدد الطرق لاختيار k عنصر من n عنصر:</p>
                            <div class="theory-formula">C(n,k) = n! / (k!(n-k)!)</div>
                            <p>حيث C(n,k) هو العدد في الصف n والعمود k من مثلث باسكال.</p>
                            <p>هذه العلاقة أساسية في التوافقيات ونظرية الاحتمالات.</p>
                        </div>
                    </div>
                </div>
                
                <div class="tab-content" id="magic-tab">
                    <h3>الطلسم والأسرار</h3>
                    <p>في التراث الرياضي العربي والإسلامي، ارتبط مثلث باسكال بالعديد من التطبيقات في علم الطلسم والأسرار.</p>
                    <p>طريقة حساب الطلسم:</p>
                    <ol>
                        <li>اختر عدد الطبقات المرغوبة (عادة أعداد فردية)</li>
                        <li>حدد النقطة المركزية في المثلث</li>
                        <li>استخدم الأعداد في مسارات محددة لتكوين أنماط رياضية</li>
                        <li>اجمع الأعداد في مجموعات خاصة وفقاً للقواعد المطلوبة</li>
                    </ol>
                    <p>استخراج الأسرار من الطلسم:</p>
                    <ul>
                        <li>الأسرار العددية: تحليل العلاقات بين الأعداد في المثلث</li>
                        <li>الأسرار الهندسية: دراسة الأشكال والنماذج المتكونة</li>
                        <li>الأسرار الكونية: ربط الأعداد بالنظريات الفلكية والفلسفية</li>
                    </ul>
                    <p>يمكن استخدام هذه الأسرار في التطبيقات العملية مثل التشفير والتنبؤ وتحليل البيانات.</p>
                </div>
                
                <div class="tab-content" id="scientists-tab">
                    <h3>معادلات العلماء من مثلث باسكال</h3>
                    <div class="formulas" id="scientists-formulas">
                        <!-- سيتم ملؤها ديناميكياً -->
                    </div>
                </div>
                
                <div class="tab-content" id="abjad-tab">
                    <h3>حساب الجمل والاستنطاق</h3>
                    <div class="theory-section">
                        <div class="theory-title">حساب الجمل الكبير</div>
                        <div class="theory-content">
                            <p>حساب الجمل هو نظام قديم لربط الحروف العربية بالأعداد. يستخدم في العديد من التطبيقات الصوفية والرياضية.</p>
                            <div class="theory-formula">
                                أ=1, ب=2, ج=3, د=4, ه=5, و=6, ز=7, ح=8, ط=9, ي=10, ك=20, ل=30, م=40, ن=50, س=60, ع=70, ف=80, ص=90, ق=100, ر=200, ش=300, ت=400, ث=500, خ=600, ذ=700, ض=800, ظ=900, غ=1000
                            </div>
                            <p>مثال: كلمة "الر" = أ (1) + ل (30) + ر (200) = 231</p>
                            <p>كلمة "بي" = ب (2) + ي (10) = 12</p>
                        </div>
                    </div>
                    
                    <div class="theory-section">
                        <div class="theory-title">الاستنطاق في المربعات</div>
                        <div class="theory-content">
                            <p>في هذا التطبيق، يمكنك استنطاق الحروف والكلمات وعرضها في مربعات مثلث باسكال.</p>
                            <p>كل خلية تعرض:</p>
                            <ul>
                                <li>الاسم (سورة، اسم الله، رسول، فرعون، إلخ)</li>
                                <li>السورة (إن وجدت)</li>
                                <li>العدد (حساب الجمل أو رقم السورة)</li>
                            </ul>
                            <p>يمكنك التبديل بين أنواع البيانات المختلفة باستخدام خيارات "نوع البيانات" في لوحة التحكم.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>تم تطوير هذا التطبيق باستخدام HTML5 و Canvas و JavaScript</p>
            <p>مثلث باسكال العجيب - النسخة المتطورة مع الاستنطاق 2023</p>
        </footer>
    </div>

    <script>
        // العناصر الرئيسية
        const canvas = document.getElementById('pascalCanvas');
        const ctx = canvas.getContext('2d');
        
        // عناصر التحكم
        const layersSlider = document.getElementById('layers');
        const layersValue = document.getElementById('layers-value');
        const rotationSlider = document.getElementById('rotation');
        const rotationValue = document.getElementById('rotation-value');
        const zoomSlider = document.getElementById('zoom');
        const zoomValue = document.getElementById('zoom-value');
        const resetButton = document.getElementById('reset-view');
        const calculateButton = document.getElementById('calculate');
        const resetTriangleButton = document.getElementById('reset-triangle');
        const undoButton = document.getElementById('undo-btn');
        const triangleProperties = document.getElementById('triangle-properties');
        const formulasContainer = document.getElementById('formulas-container');
        const scientistsFormulasContainer = document.getElementById('scientists-formulas');
        const statusBar = document.getElementById('status-bar');
        const explodedContainer = document.getElementById('exploded-container');
        
        // عناصر الأنماط والألوان
        const displayStyles = document.querySelectorAll('.display-style');
        const colorSchemes = document.querySelectorAll('.color-scheme');
        const dataTypes = document.querySelectorAll('.data-type');
        
        // تبويبات
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        
        // حالة التطبيق
        let state = {
            layers: 5,
            rotation: 0,
            zoom: 1.0,
            offsetX: 0,
            offsetY: 0,
            isDragging: false,
            lastX: 0,
            lastY: 0,
            triangleData: [],
            displayStyle: 'hexagon',
            colorScheme: 'default',
            dataType: 'numbers',
            selectedHexagons: new Set(),
            history: [],
            ctrlPressed: false,
            explodedCells: new Map() // خلايا مفككة مع شرحها
        };
        
        // أنظمة الألوان
        const colorSchemesMap = {
            default: {
                primary: '#4a148c',
                secondary: '#7b1fa2',
                accent: '#e1bee7',
                hexagon: '#e1f5fe',
                hexagonBorder: '#7b1fa2',
                text: '#212121',
                background: '#f5f5f5'
            },
            green: {
                primary: '#00695c',
                secondary: '#004d40',
                accent: '#b2dfdb',
                hexagon: '#e0f2f1',
                hexagonBorder: '#00695c',
                text: '#212121',
                background: '#f5f5f5'
            },
            red: {
                primary: '#b71c1c',
                secondary: '#c62828',
                accent: '#ffcdd2',
                hexagon: '#ffebee',
                hexagonBorder: '#b71c1c',
                text: '#212121',
                background: '#f5f5f5'
            },
            blue: {
                primary: '#0d47a1',
                secondary: '#1565c0',
                accent: '#bbdefb',
                hexagon: '#e3f2fd',
                hexagonBorder: '#0d47a1',
                text: '#212121',
                background: '#f5f5f5'
            },
            purple: {
                primary: '#4a148c',
                secondary: '#6a1b9a',
                accent: '#e1bee7',
                hexagon: '#f3e5f5',
                hexagonBorder: '#4a148c',
                text: '#212121',
                background: '#f5f5f5'
            }
        };
        
        // بيانات الاستنطاق
        const dataSets = {
            // السور القرآنية
            suras: [
                { name: "الفاتحة", number: 1, details: "مكية" },
                { name: "البقرة", number: 2, details: "مدنية" },
                { name: "آل عمران", number: 3, details: "مدنية" },
                { name: "النساء", number: 4, details: "مدنية" },
                { name: "المائدة", number: 5, details: "مدنية" },
                { name: "الأنعام", number: 6, details: "مكية" },
                { name: "الأعراف", number: 7, details: "مكية" },
                { name: "الأنفال", number: 8, details: "مدنية" },
                { name: "التوبة", number: 9, details: "مدنية" },
                { name: "يونس", number: 10, details: "مكية" },
                { name: "هود", number: 11, details: "مكية" },
                { name: "يوسف", number: 12, details: "مكية" },
                { name: "الرعد", number: 13, details: "مدنية" },
                { name: "إبراهيم", number: 14, details: "مكية" },
                { name: "الحجر", number: 15, details: "مكية" },
                { name: "النحل", number: 16, details: "مكية" },
                { name: "الإسراء", number: 17, details: "مكية" },
                { name: "الكهف", number: 18, details: "مكية" },
                { name: "مريم", number: 19, details: "مكية" },
                { name: "طه", number: 20, details: "مكية" },
                { name: "الأنبياء", number: 21, details: "مكية" },
                { name: "الحج", number: 22, details: "مدنية" },
                { name: "المؤمنون", number: 23, details: "مكية" },
                { name: "النور", number: 24, details: "مدنية" },
                { name: "الفرقان", number: 25, details: "مكية" },
                { name: "الشعراء", number: 26, details: "مكية" },
                { name: "النمل", number: 27, details: "مكية" },
                { name: "القصص", number: 28, details: "مكية" },
                { name: "العنكبوت", number: 29, details: "مكية" },
                { name: "الروم", number: 30, details: "مكية" },
                { name: "لقمان", number: 31, details: "مكية" },
                { name: "السجدة", number: 32, details: "مكية" },
                { name: "الأحزاب", number: 33, details: "مدنية" },
                { name: "سبأ", number: 34, details: "مكية" },
                { name: "فاطر", number: 35, details: "مكية" },
                { name: "يس", number: 36, details: "مكية" },
                { name: "الصافات", number: 37, details: "مكية" },
                { name: "ص", number: 38, details: "مكية" },
                { name: "الزمر", number: 39, details: "مكية" },
                { name: "غافر", number: 40, details: "مكية" },
                { name: "فصلت", number: 41, details: "مكية" },
                { name: "الشورى", number: 42, details: "مكية" },
                { name: "الزخرف", number: 43, details: "مكية" },
                { name: "الدخان", number: 44, details: "مكية" },
                { name: "الجاثية", number: 45, details: "مكية" },
                { name: "الأحقاف", number: 46, details: "مكية" },
                { name: "محمد", number: 47, details: "مدنية" },
                { name: "الفتح", number: 48, details: "مدنية" },
                { name: "الحجرات", number: 49, details: "مدنية" },
                { name: "ق", number: 50, details: "مكية" },
                { name: "الذاريات", number: 51, details: "مكية" },
                { name: "الطور", number: 52, details: "مكية" },
                { name: "النجم", number: 53, details: "مكية" },
                { name: "القمر", number: 54, details: "مكية" },
                { name: "الرحمن", number: 55, details: "مدنية" },
                { name: "الواقعة", number: 56, details: "مكية" },
                { name: "الحديد", number: 57, details: "مدنية" },
                { name: "المجادلة", number: 58, details: "مدنية" },
                { name: "الحشر", number: 59, details: "مدنية" },
                { name: "الممتحنة", number: 60, details: "مدنية" },
                { name: "الصف", number: 61, details: "مدنية" },
                { name: "الجمعة", number: 62, details: "مدنية" },
                { name: "المنافقون", number: 63, details: "مدنية" },
                { name: "التغابن", number: 64, details: "مدنية" },
                { name: "الطلاق", number: 65, details: "مدنية" },
                { name: "التحريم", number: 66, details: "مدنية" },
                { name: "الملك", number: 67, details: "مكية" },
                { name: "القلم", number: 68, details: "مكية" },
                { name: "الحاقة", number: 69, details: "مكية" },
                { name: "المعارج", number: 70, details: "مكية" },
                { name: "نوح", number: 71, details: "مكية" },
                { name: "الجن", number: 72, details: "مكية" },
                { name: "المزمل", number: 73, details: "مكية" },
                { name: "المدثر", number: 74, details: "مكية" },
                { name: "القيامة", number: 75, details: "مكية" },
                { name: "الإنسان", number: 76, details: "مدنية" },
                { name: "المرسلات", number: 77, details: "مكية" },
                { name: "النبأ", number: 78, details: "مكية" },
                { name: "النازعات", number: 79, details: "مكية" },
                { name: "عبس", number: 80, details: "مكية" },
                { name: "التكوير", number: 81, details: "مكية" },
                { name: "الانفطار", number: 82, details: "مكية" },
                { name: "المطففين", number: 83, details: "مكية" },
                { name: "الانشقاق", number: 84, details: "مكية" },
                { name: "البروج", number: 85, details: "مكية" },
                { name: "الطارق", number: 86, details: "مكية" },
                { name: "الأعلى", number: 87, details: "مكية" },
                { name: "الغاشية", number: 88, details: "مكية" },
                { name: "الفجر", number: 89, details: "مكية" },
                { name: "البلد", number: 90, details: "مكية" },
                { name: "الشمس", number: 91, details: "مكية" },
                { name: "الليل", number: 92, details: "مكية" },
                { name: "الضحى", number: 93, details: "مكية" },
                { name: "الشرح", number: 94, details: "مكية" },
                { name: "التين", number: 95, details: "مكية" },
                { name: "العلق", number: 96, details: "مكية" },
                { name: "القدر", number: 97, details: "مكية" },
                { name: "البينة", number: 98, details: "مدنية" },
                { name: "الزلزلة", number: 99, details: "مدنية" },
                { name: "العاديات", number: 100, details: "مكية" },
                { name: "القارعة", number: 101, details: "مكية" },
                { name: "التكاثر", number: 102, details: "مكية" },
                { name: "العصر", number: 103, details: "مكية" },
                { name: "الهمزة", number: 104, details: "مكية" },
                { name: "الفيل", number: 105, details: "مكية" },
                { name: "قريش", number: 106, details: "مكية" },
                { name: "الماعون", number: 107, details: "مكية" },
                { name: "الكوثر", number: 108, details: "مكية" },
                { name: "الكافرون", number: 109, details: "مكية" },
                { name: "النصر", number: 110, details: "مدنية" },
                { name: "المسد", number: 111, details: "مكية" },
                { name: "الإخلاص", number: 112, details: "مكية" },
                { name: "الفلق", number: 113, details: "مكية" },
                { name: "الناس", number: 114, details: "مكية" }
            ],
            
            // أسماء الله الحسنى
            allahNames: [
                { name: "الرحمن", number: 298, details: "ذو الرحمة الواسعة" },
                { name: "الرحيم", number: 258, details: "ذو الرحمة الخاصة" },
                { name: "الملك", number: 90, details: "المالك لكل شيء" },
                { name: "القدوس", number: 170, details: "المنزه عن النقائص" },
                { name: "السلام", number: 131, details: "منزه عن كل عيب" },
                { name: "المؤمن", number: 137, details: "المصدق لعباده" },
                { name: "المهيمن", number: 145, details: "الشهيد على خلقه" },
                { name: "العزيز", number: 94, details: "المنيع الذي لا يغلب" },
                { name: "الجبار", number: 206, details: "الذي يجبر الضعيف" },
                { name: "المتكبر", number: 662, details: "المتعالي عن صفات الخلق" },
                { name: "الخالق", number: 731, details: "المبدع للخلق" },
                { name: "البارئ", number: 213, details: "المصور للخلق" },
                { name: "المصور", number: 336, details: "منشئ الصور المختلفة" },
                { name: "الغفار", number: 1281, details: "ستار الذنوب" },
                { name: "القهار", number: 306, details: "الغالب لكل شيء" },
                { name: "الوهاب", number: 14, details: "المنعم بالعطايا" },
                { name: "الرزاق", number: 308, details: "المتفضل بالأرزاق" },
                { name: "الفتاح", number: 489, details: "الذي يفتح المغلقات" },
                { name: "العليم", number: 150, details: "المحيط بكل شيء علماً" },
                { name: "القابض", number: 903, details: "الذي يضيق الرزق" },
                { name: "الباسط", number: 72, details: "الذي يوسع الرزق" },
                { name: "الخافض", number: 1481, details: "الذي يذل من يشاء" },
                { name: "الرافع", number: 351, details: "الذي يعز من يشاء" },
                { name: "المعز", number: 117, details: "الذي يهب العزة" },
                { name: "المذل", number: 770, details: "الذي ينزع العزة" },
                { name: "السميع", number: 180, details: "الذي يسمع كل شيء" },
                { name: "البصير", number: 302, details: "الذي يرى كل شيء" },
                { name: "الحكم", number: 68, details: "الذي يحكم بين الخلق" },
                { name: "العدل", number: 104, details: "المنزه عن الظلم" },
                { name: "اللطيف", number: 129, details: "الذي يعلم دقائق الأمور" },
                { name: "الخبير", number: 812, details: "المحيط علمه بالخفايا" },
                { name: "الحليم", number: 88, details: "الصفوح عن الزلات" },
                { name: "العظيم", number: 1020, details: "ذو العظمة والجلال" },
                { name: "الغفور", number: 1286, details: "الكثير المغفرة" },
                { name: "الشكور", number: 526, details: "المقبل للقليل من الطاعة" },
                { name: "العلي", number: 110, details: "الرفيع فوق خلقه" },
                { name: "الكبير", number: 232, details: "العظيم في ذاته وصفاته" },
                { name: "الحفيظ", number: 998, details: "الحافظ لكل شيء" },
                { name: "المقيت", number: 550, details: "الذي يوصل الأرزاق" },
                { name: "الحسيب", number: 80, details: "الكافي لعباده" },
                { name: "الجليل", number: 73, details: "ذو الجلال والعظمة" },
                { name: "الكريم", number: 270, details: "الواسع العطاء" },
                { name: "الرقيب", number: 312, details: "المراقب لأعمال العباد" },
                { name: "المجيب", number: 55, details: "الذي يجيب الدعاء" },
                { name: "الواسع", number: 137, details: "الغني الذي وسع كل شيء" },
                { name: "الحكيم", number: 78, details: "ذي الحكمة في أفعاله" },
                { name: "الودود", number: 20, details: "المحب لعباده" },
                { name: "المجيد", number: 57, details: "ذي المجد والعظمة" },
                { name: "الباعث", number: 573, details: "الذي يبعث الخلق" },
                { name: "الشهيد", number: 319, details: "الذي يشهد على كل شيء" },
                { name: "الحق", number: 108, details: "الذي لا يخلف وعده" },
                { name: "الوكيل", number: 66, details: "الكفيل بأرزاق العباد" },
                { name: "القوي", number: 116, details: "ذي القوة التامة" },
                { name: "المتين", number: 500, details: "الشديد الذي لا ينال" },
                { name: "الولي", number: 46, details: "الناصر لأوليائه" },
                { name: "الحميد", number: 62, details: "المستحق للحمد" },
                { name: "المحصي", number: 148, details: "العالم بعدد كل شيء" },
                { name: "المبدئ", number: 56, details: "الذي أنشأ الخلق" },
                { name: "المعيد", number: 124, details: "الذي يعيد الخلق" },
                { name: "المحيي", number: 68, details: "الذي يحيي الموتى" },
                { name: "المميت", number: 490, details: "الذي يميت الأحياء" },
                { name: "الحي", number: 18, details: "ذي الحياة الأبدية" },
                { name: "القيوم", number: 156, details: "القائم بنفسه" },
                { name: "الواجد", number: 14, details: "الغني الذي لا يفقد" },
                { name: "الماجد", number: 48, details: "ذي الكرم والمجد" },
                { name: "الواحد", number: 19, details: "المنفرد بالوحدانية" },
                { name: "الأحد", number: 13, details: "الذي لم يلد ولم يولد" },
                { name: "الصمد", number: 134, details: "الذي تصمد إليه الخلائق" },
                { name: "القادر", number: 305, details: "ذي القدرة التامة" },
                { name: "المقتدر", number: 744, details: "ذي التصرف المطلق" },
                { name: "المقدم", number: 184, details: "الذي يقدم من يشاء" },
                { name: "المؤخر", number: 847, details: "الذي يؤخر من يشاء" },
                { name: "الأول", number: 37, details: "الذي ليس قبله شيء" },
                { name: "الآخر", number: 802, details: "الذي ليس بعده شيء" },
                { name: "الظاهر", number: 1106, details: "الذي علا فوق كل شيء" },
                { name: "الباطن", number: 62, details: "الذي دنا من كل شيء" },
                { name: "الوالي", number: 47, details: "المتصرف في الكون" },
                { name: "المتعالي", number: 551, details: "المنزه عن النقائص" },
                { name: "البر", number: 202, details: "اللطيف بعباده" },
                { name: "التواب", number: 409, details: "الذي يقبل التوبة" },
                { name: "المنتقم", number: 630, details: "الذي ينتصر من الظالمين" },
                { name: "العفو", number: 156, details: "الذي يصفح عن الذنوب" },
                { name: "الرؤوف", number: 292, details: "ذي الرحمة الواسعة" },
                { name: "مالك الملك", number: 212, details: "صاحب الملك والتصرف" },
                { name: "ذو الجلال والإكرام", number: 1100, details: "صاحب العظمة والكرم" },
                { name: "المقسط", number: 339, details: "الذي يحكم بالعدل" },
                { name: "الجامع", number: 114, details: "الذي يجمع الخلائق" },
                { name: "الغني", number: 1060, details: "المستغني عن الخلق" },
                { name: "المغني", number: 1100, details: "الذي يغني من يشاء" },
                { name: "المانع", number: 161, details: "الذي يمنع العطاء" },
                { name: "الضار", number: 1001, details: "الذي يضر من يشاء" },
                { name: "النافع", number: 201, details: "الذي ينفع من يشاء" },
                { name: "النور", number: 256, details: "الهادي إلى الحق" },
                { name: "الهادي", number: 20, details: "الذي يهدي إلى الصراط" },
                { name: "البديع", number: 86, details: "المبتدع للخلق" },
                { name: "الباقي", number: 113, details: "الدائم الذي لا يزول" },
                { name: "الوارث", number: 707, details: "الباقي بعد فناء الخلق" },
                { name: "الرشيد", number: 514, details: "الذي يرشد إلى الحق" },
                { name: "الصبور", number: 298, details: "ذي الصبر على المعاصي" }
            ],
            
            // الرسل والأنبياء
            prophets: [
                { name: "آدم", number: 45, details: "أبو البشر" },
                { name: "إدريس", number: 275, details: "أول من خط بالقلم" },
                { name: "نوح", number: 64, details: "صاحب السفينة" },
                { name: "هود", number: 15, details: "رسول إلى عاد" },
                { name: "صالح", number: 109, details: "رسول إلى ثمود" },
                { name: "إبراهيم", number: 258, details: "خليل الله" },
                { name: "لوط", number: 71, details: "ابن أخ إبراهيم" },
                { name: "إسماعيل", number: 211, details: "الذبيح" },
                { name: "إسحاق", number: 169, details: "ابن إبراهيم" },
                { name: "يعقوب", number: 182, details: "إسرائيل" },
                { name: "يوسف", number: 156, details: "الصديق" },
                { name: "أيوب", number: 43, details: "الصابر" },
                { name: "شعيب", number: 149, details: "خطيب الأنبياء" },
                { name: "موسى", number: 116, details: "كليم الله" },
                { name: "هارون", number: 261, details: "أخو موسى" },
                { name: "داود", number: 15, details: "الملك النبي" },
                { name: "سليمان", number: 175, details: "ابن داود" },
                { name: "إلياس", number: 82, details: "رسول إلى بني إسرائيل" },
                { name: "اليسع", number: 201, details: "خليفة إلياس" },
                { name: "يونس", number: 126, details: "صاحب الحوت" },
                { name: "زكريا", number: 241, details: "أبو يحيى" },
                { name: "يحيى", number: 32, details: "ابن زكريا" },
                { name: "عيسى", number: 150, details: "روح الله" },
                { name: "محمد", number: 92, details: "خاتم الأنبياء" }
            ],
            
            // الفراعنة
            pharaohs: [
                { name: "نارمر", number: 255, details: "موحد مصر" },
                { name: "خوفو", number: 56, details: "باني الهرم الأكبر" },
                { name: "خفرع", number: 355, details: "باني الهرم الثاني" },
                { name: "منكاورع", number: 336, details: "باني الهرم الثالث" },
                { name: "أحمس", number: 154, details: "طرد الهكسوس" },
                { name: "حتشبسوت", number: 1285, details: "الملكة الفرعونية" },
                { name: "تحتمس الثالث", number: 1290, details: "الإمبراطور المحارب" },
                { name: "أمنحتب الثالث", number: 250, details: "عصر الازدهار" },
                { name: "أخناتون", number: 401, details: "المصلح الديني" },
                { name: "توت عنخ آمون", number: 1200, details: "الملك الطفل" },
                { name: "رمسيس الثاني", number: 1100, details: "رمسيس العظيم" },
                { name: "رمسيس الثالث", number: 900, details: "آخر الفراعنة العظام" },
                { name: "نفرتيتي", number: 630, details: "الزوجة الملكية" },
                { name: "كليوباترا", number: 571, details: "آخر ملكات البطالمة" }
            ],
            
            // حساب الجمل
            abjad: [
                { name: "الر", number: 231, details: "أ ل ر = 1+30+200" },
                { name: "بي", number: 12, details: "ب ي = 2+10" },
                { name: "حم", number: 48, details: "ح م = 8+40" },
                { name: "عسق", number: 270, details: "ع س ق = 70+60+100" },
                { name: "كهيعص", number: 195, details: "ك هـ ي ع ص = 20+5+10+70+90" },
                { name: "طس", number: 69, details: "ط س = 9+60" },
                { name: "يس", number: 70, details: "ي س = 10+60" },
                { name: "ص", number: 90, details: "ص = 90" },
                { name: "ق", number: 100, details: "ق = 100" },
                { name: "ن", number: 50, details: "ن = 50" }
            ]
        };
        
        // تهيئة حجم Canvas
        function initCanvas() {
            const container = canvas.parentElement;
            // استخدام دقة عالية للـ Canvas
            const dpr = window.devicePixelRatio || 1;
            canvas.width = container.clientWidth * dpr;
            canvas.height = container.clientHeight * dpr;
            canvas.style.width = container.clientWidth + 'px';
            canvas.style.height = container.clientHeight + 'px';
            ctx.scale(dpr, dpr);
            
            // حساب الإزاحة لجعل المثلث في المركز
            state.offsetX = container.clientWidth / 2;
            state.offsetY = container.clientHeight / 2;
            
            drawPascalTriangle();
        }
        
        // توليد مثلث باسكال
        function generatePascalTriangle(layers) {
            const triangle = [];
            for (let i = 0; i < layers; i++) {
                triangle[i] = [];
                for (let j = 0; j <= i; j++) {
                    if (j === 0 || j === i) {
                        triangle[i][j] = 1;
                    } else {
                        triangle[i][j] = triangle[i-1][j-1] + triangle[i-1][j];
                    }
                }
            }
            return triangle;
        }
        
        // رسم مثلث باسكال
        function drawPascalTriangle() {
            // مسح Canvas
            const container = canvas.parentElement;
            ctx.clearRect(0, 0, container.clientWidth, container.clientHeight);
            
            // تطبيق التحويلات
            ctx.save();
            ctx.translate(state.offsetX, state.offsetY);
            ctx.rotate(state.rotation * Math.PI / 180);
            ctx.scale(state.zoom, state.zoom);
            
            // توليد بيانات المثلث
            state.triangleData = generatePascalTriangle(state.layers);
            
            // الرسم بناءً على نمط العرض المحدد
            switch(state.displayStyle) {
                case 'hexagon':
                    drawHexagonPattern();
                    break;
                case 'triangle':
                    drawTrianglePattern();
                    break;
                case 'circle':
                    drawCirclePattern();
                    break;
                case 'square':
                    drawSquarePattern();
                    break;
            }
            
            ctx.restore();
        }
        
        // رسم نمط خلية النحل
        function drawHexagonPattern() {
            const hexSize = Math.max(20, 40 - state.layers * 0.3); // تقليل الحجم مع زيادة الطبقات
            const hexWidth = Math.sqrt(3) * hexSize;
            const hexHeight = 2 * hexSize;
            
            // رسم السداسيات
            for (let row = 0; row < state.triangleData.length; row++) {
                for (let col = 0; col < state.triangleData[row].length; col++) {
                    // حساب موقع السداسي
                    const x = (col - row/2) * hexWidth;
                    const y = row * hexHeight * 0.75;
                    
                    // رسم السداسي
                    drawHexagon(x, y, hexSize, state.triangleData[row][col], row, col);
                }
            }
        }
        
        // رسم نمط المثلث التقليدي
        function drawTrianglePattern() {
            const cellSize = Math.max(20, 40 - state.layers * 0.3);
            
            for (let row = 0; row < state.triangleData.length; row++) {
                for (let col = 0; col < state.triangleData[row].length; col++) {
                    const x = (col - row/2) * cellSize;
                    const y = row * cellSize;
                    
                    // رسم المثلث
                    drawTriangleCell(x, y, cellSize, state.triangleData[row][col], row, col);
                }
            }
        }
        
        // رسم نمط الدوائر
        function drawCirclePattern() {
            const radius = Math.max(10, 20 - state.layers * 0.15);
            const spacing = Math.max(25, 45 - state.layers * 0.3);
            
            for (let row = 0; row < state.triangleData.length; row++) {
                for (let col = 0; col < state.triangleData[row].length; col++) {
                    const x = (col - row/2) * spacing;
                    const y = row * spacing;
                    
                    // رسم الدائرة
                    drawCircle(x, y, radius, state.triangleData[row][col], row, col);
                }
            }
        }
        
        // رسم نمط المربعات
        function drawSquarePattern() {
            const size = Math.max(15, 35 - state.layers * 0.25);
            const spacing = Math.max(20, 40 - state.layers * 0.3);
            
            for (let row = 0; row < state.triangleData.length; row++) {
                for (let col = 0; col < state.triangleData[row].length; col++) {
                    const x = (col - row/2) * spacing;
                    const y = row * spacing;
                    
                    // رسم المربع
                    drawSquare(x, y, size, state.triangleData[row][col], row, col);
                }
            }
        }
        
        // رسم شكل سداسي
        function drawHexagon(x, y, size, number, row, col) {
            const hexId = `${row}-${col}`;
            const isSelected = state.selectedHexagons.has(hexId);
            const isExploded = state.explodedCells.has(hexId);
            const colors = colorSchemesMap[state.colorScheme];
            
            if (isExploded) return; // لا ترسم الخلايا المفككة
            
            ctx.beginPath();
            for (let i = 0; i < 6; i++) {
                const angle = (Math.PI / 3) * i;
                const hx = x + size * Math.cos(angle);
                const hy = y + size * Math.sin(angle);
                if (i === 0) {
                    ctx.moveTo(hx, hy);
                } else {
                    ctx.lineTo(hx, hy);
                }
            }
            ctx.closePath();
            
            // تلوين السداسي
            if (isSelected) {
                ctx.fillStyle = colors.accent;
                ctx.fill();
                ctx.strokeStyle = colors.primary;
                ctx.lineWidth = 3;
            } else {
                ctx.fillStyle = number % 2 === 0 ? colors.hexagon : colors.accent;
                ctx.fill();
                ctx.strokeStyle = colors.hexagonBorder;
                ctx.lineWidth = 1;
            }
            ctx.stroke();
            
            // كتابة البيانات
            drawCellContent(x, y, number, row, col);
        }
        
        // رسم خلية مثلثية
        function drawTriangleCell(x, y, size, number, row, col) {
            const cellId = `${row}-${col}`;
            const isSelected = state.selectedHexagons.has(cellId);
            const isExploded = state.explodedCells.has(cellId);
            const colors = colorSchemesMap[state.colorScheme];
            
            if (isExploded) return; // لا ترسم الخلايا المفككة
            
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineTo(x + size/2, y + size);
            ctx.lineTo(x - size/2, y + size);
            ctx.closePath();
            
            // تلوين المثلث
            if (isSelected) {
                ctx.fillStyle = colors.accent;
                ctx.fill();
                ctx.strokeStyle = colors.primary;
                ctx.lineWidth = 3;
            } else {
                ctx.fillStyle = number % 2 === 0 ? colors.hexagon : colors.accent;
                ctx.fill();
                ctx.strokeStyle = colors.hexagonBorder;
                ctx.lineWidth = 1;
            }
            ctx.stroke();
            
            // كتابة البيانات
            drawCellContent(x, y + size/2, number, row, col);
        }
        
        // رسم دائرة
        function drawCircle(x, y, radius, number, row, col) {
            const circleId = `${row}-${col}`;
            const isSelected = state.selectedHexagons.has(circleId);
            const isExploded = state.explodedCells.has(circleId);
            const colors = colorSchemesMap[state.colorScheme];
            
            if (isExploded) return; // لا ترسم الخلايا المفككة
            
            ctx.beginPath();
            ctx.arc(x, y, radius, 0, Math.PI * 2);
            ctx.closePath();
            
            // تلوين الدائرة
            if (isSelected) {
                ctx.fillStyle = colors.accent;
                ctx.fill();
                ctx.strokeStyle = colors.primary;
                ctx.lineWidth = 3;
            } else {
                ctx.fillStyle = number % 2 === 0 ? colors.hexagon : colors.accent;
                ctx.fill();
                ctx.strokeStyle = colors.hexagonBorder;
                ctx.lineWidth = 1;
            }
            ctx.stroke();
            
            // كتابة البيانات
            drawCellContent(x, y, number, row, col);
        }
        
        // رسم مربع
        function drawSquare(x, y, size, number, row, col) {
            const squareId = `${row}-${col}`;
            const isSelected = state.selectedHexagons.has(squareId);
            const isExploded = state.explodedCells.has(squareId);
            const colors = colorSchemesMap[state.colorScheme];
            
            if (isExploded) return; // لا ترسم الخلايا المفككة
            
            ctx.beginPath();
            ctx.rect(x - size/2, y - size/2, size, size);
            ctx.closePath();
            
            // تلوين المربع
            if (isSelected) {
                ctx.fillStyle = colors.accent;
                ctx.fill();
                ctx.strokeStyle = colors.primary;
                ctx.lineWidth = 3;
            } else {
                ctx.fillStyle = number % 2 === 0 ? colors.hexagon : colors.accent;
                ctx.fill();
                ctx.strokeStyle = colors.hexagonBorder;
                ctx.lineWidth = 1;
            }
            ctx.stroke();
            
            // كتابة البيانات
            drawCellContent(x, y, number, row, col);
        }
        
        // رسم محتوى الخلية
        function drawCellContent(x, y, number, row, col) {
            const colors = colorSchemesMap[state.colorScheme];
            ctx.fillStyle = colors.text;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            
            // الحصول على البيانات بناءً على النوع المحدد
            let cellData = getCellData(number, row, col);
            
            // تحديد حجم الخط بناءً على حجم الخلية ونوع البيانات
            let fontSize = state.dataType === 'numbers' ? 14 : 10;
            if (state.layers > 20) fontSize = Math.max(8, fontSize - 2);
            if (state.layers > 50) fontSize = Math.max(6, fontSize - 2);
            
            ctx.font = `${fontSize}px Arial`;
            
            if (state.dataType === 'numbers') {
                // إذا كان العدد كبير جداً، عرضه بشكل مختصر
                let displayNumber = number;
                if (number > 1e6) {
                    displayNumber = number.toExponential(2);
                }
                ctx.fillText(displayNumber, x, y);
            } else {
                // عرض البيانات النصية
                ctx.fillText(cellData.name, x, y - (fontSize * 0.8));
                
                if (cellData.details) {
                    ctx.font = `${fontSize * 0.7}px Arial`;
                    ctx.fillText(cellData.details, x, y);
                }
                
                ctx.font = `${fontSize * 0.8}px Arial`;
                ctx.fillText(cellData.number.toString(), x, y + (fontSize * 0.8));
            }
        }
        
        // الحصول على بيانات الخلية بناءً على النوع المحدد
        function getCellData(number, row, col) {
            const dataSet = dataSets[state.dataType];
            if (!dataSet) {
                return { name: number.toString(), number: number, details: "" };
            }
            
            // حساب الفهرس بناءً على الصف والعمود
            const index = (row * (row + 1) / 2 + col) % dataSet.length;
            return dataSet[index];
        }
        
        // الحصول على إحداثيات الخلية من إحداثيات الماوس
        function getCellFromMouse(x, y) {
            // تطبيق التحويلات العكسية
            const transformedX = (x - state.offsetX) / state.zoom;
            const transformedY = (y - state.offsetY) / state.zoom;
            
            // تعويض التدوير
            const angle = -state.rotation * Math.PI / 180;
            const rotatedX = transformedX * Math.cos(angle) - transformedY * Math.sin(angle);
            const rotatedY = transformedX * Math.sin(angle) + transformedY * Math.cos(angle);
            
            // البحث عن الخلية الأقرب
            let minDistance = Infinity;
            let closestCell = null;
            
            for (let row = 0; row < state.triangleData.length; row++) {
                for (let col = 0; col < state.triangleData[row].length; col++) {
                    let cellX, cellY;
                    
                    // حساب موقع الخلية بناءً على نمط العرض
                    switch(state.displayStyle) {
                        case 'hexagon':
                            const hexSize = Math.max(20, 40 - state.layers * 0.3);
                            const hexWidth = Math.sqrt(3) * hexSize;
                            const hexHeight = 2 * hexSize;
                            cellX = (col - row/2) * hexWidth;
                            cellY = row * hexHeight * 0.75;
                            break;
                        case 'triangle':
                            const cellSize = Math.max(20, 40 - state.layers * 0.3);
                            cellX = (col - row/2) * cellSize;
                            cellY = row * cellSize;
                            break;
                        case 'circle':
                            const spacing = Math.max(25, 45 - state.layers * 0.3);
                            cellX = (col - row/2) * spacing;
                            cellY = row * spacing;
                            break;
                        case 'square':
                            const squareSpacing = Math.max(20, 40 - state.layers * 0.3);
                            cellX = (col - row/2) * squareSpacing;
                            cellY = row * squareSpacing;
                            break;
                    }
                    
                    const distance = Math.sqrt((rotatedX - cellX) ** 2 + (rotatedY - cellY) ** 2);
                    const threshold = state.displayStyle === 'hexagon' ? 40 : 30;
                    
                    if (distance < threshold && distance < minDistance) {
                        minDistance = distance;
                        closestCell = { row, col };
                    }
                }
            }
            
            return closestCell;
        }
        
        // تفكيك المثلث (إزالة الخلية المحددة وإضافتها للوحة الشرح)
        function explodeTriangle(row, col) {
            const cellId = `${row}-${col}`;
            
            // إذا كانت الخلية مفككة بالفعل، لا تفعل شيئاً
            if (state.explodedCells.has(cellId)) return;
            
            // حفظ الحالة الحالية في التاريخ
            state.history.push({
                selectedHexagons: new Set(state.selectedHexagons),
                explodedCells: new Map(state.explodedCells)
            });
            undoButton.disabled = false;
            
            // إضافة الخلية المحددة إلى المجموعة المحددة
            state.selectedHexagons.add(cellId);
            
            // إضافة الخلية إلى الخلايا المفككة مع شرحها
            const number = state.triangleData[row][col];
            const explanation = generateNumberExplanation(number, row, col);
            state.explodedCells.set(cellId, {
                number,
                row,
                col,
                explanation
            });
            
            drawPascalTriangle();
            updateExplodedPanel();
            updateStatusBar(`تم تفكيك الخلية عند الصف ${row+1}, العمود ${col+1}`);
        }
        
        // توليد شرح للرقم
        function generateNumberExplanation(number, row, col) {
            let explanation = "";
            
            // إذا كان نوع البيانات غير الأرقام، أضف معلومات إضافية
            if (state.dataType !== 'numbers') {
                const cellData = getCellData(number, row, col);
                explanation = `الاسم: ${cellData.name} | العدد: ${cellData.number}`;
                if (cellData.details) {
                    explanation += ` | التفاصيل: ${cellData.details}`;
                }
                explanation += `. يقع هذا العنصر في الصف ${row+1}, العمود ${col+1} من المثلث.`;
                return explanation;
            }
            
            // شرح بناءً على قيمة الرقم
            if (number === 1) {
                explanation = "العدد 1: هو أساس المتتالية، ويمثل بداية كل صف ونهاية كل صف في المثلث.";
            } else if (number === 2) {
                explanation = "العدد 2: أول عدد غير أولي في المثلث، ويمثل مجموع 1+1.";
            } else if (isPrime(number)) {
                explanation = `العدد ${number}: هو عدد أولي، لا يقبل القسمة إلا على نفسه والواحد.`;
            } else {
                explanation = `العدد ${number}: هو عدد مركب، يمكن تحليله إلى عوامل أولية.`;
            }
            
            // إضافة معلومات عن الموقع
            explanation += ` يقع هذا العدد في الصف ${row+1}, العمود ${col+1} من المثلث.`;
            
            // إضافة معلومات عن كيفية تكوينه
            if (row > 0 && col > 0 && col < row) {
                const leftParent = state.triangleData[row-1][col-1];
                const rightParent = state.triangleData[row-1][col];
                explanation += ` يتكون من جمع العددين أعلاه: ${leftParent} + ${rightParent} = ${number}.`;
            }
            
            // إضافة معلومات خاصة بالأعداد المميزة
            if (number === row) {
                explanation += " هذا العدد يمثل عدداً مثلثياً.";
            }
            
            if (number === Math.pow(2, row)) {
                explanation += " هذا العدد يمثل مجموع الصف.";
            }
            
            // إضافة معلومات عن علاقته بمتسلسلة فيبوناتشي
            const fibInfo = getFibonacciInfo(number, row, col);
            if (fibInfo) {
                explanation += " " + fibInfo;
            }
            
            return explanation;
        }
        
        // الحصول على معلومات عن علاقة العدد بمتسلسلة فيبوناتشي
        function getFibonacciInfo(number, row, col) {
            // توليد متسلسلة فيبوناتشي حتى العدد 111
            let fib = [0, 1];
            for (let i = 2; fib[i-1] <= 111; i++) {
                fib[i] = fib[i-1] + fib[i-2];
            }
            
            // التحقق إذا كان العدد جزءاً من متسلسلة فيبوناتشي
            if (fib.includes(number)) {
                const index = fib.indexOf(number);
                return `هذا العدد هو العدد رقم ${index} في متسلسلة فيبوناتشي.`;
            }
            
            return null;
        }
        
        // التحقق إذا كان العدد أولياً
        function isPrime(num) {
            if (num <= 1) return false;
            if (num <= 3) return true;
            if (num % 2 === 0 || num % 3 === 0) return false;
            
            let i = 5;
            while (i * i <= num) {
                if (num % i === 0 || num % (i + 2) === 0) return false;
                i += 6;
            }
            return true;
        }
        
        // تحديث لوحة الخلايا المفككة
        function updateExplodedPanel() {
            explodedContainer.innerHTML = '';
            
            if (state.explodedCells.size === 0) {
                explodedContainer.innerHTML = '<p>لا توجد خلايا مفككة. اضغط Ctrl + زر الماوس الأيسر على أي خلية لتفكيكها.</p>';
                return;
            }
            
            state.explodedCells.forEach((cell, cellId) => {
                const explodedItem = document.createElement('div');
                explodedItem.className = 'exploded-item';
                explodedItem.id = `exploded-${cellId}`;
                
                const title = document.createElement('div');
                title.className = 'exploded-title';
                
                const numberSpan = document.createElement('span');
                numberSpan.className = 'exploded-number';
                numberSpan.textContent = `العدد: ${cell.number}`;
                
                const locationSpan = document.createElement('span');
                locationSpan.textContent = `(الصف: ${cell.row+1}, العمود: ${cell.col+1})`;
                
                const closeBtn = document.createElement('button');
                closeBtn.className = 'close-btn';
                closeBtn.innerHTML = '×';
                closeBtn.onclick = () => removeExplodedCell(cellId);
                
                title.appendChild(numberSpan);
                title.appendChild(locationSpan);
                title.appendChild(closeBtn);
                
                const content = document.createElement('div');
                content.className = 'exploded-content';
                content.textContent = cell.explanation;
                
                explodedItem.appendChild(title);
                explodedItem.appendChild(content);
                explodedContainer.appendChild(explodedItem);
            });
        }
        
        // إزالة خلية من الخلايا المفككة
        function removeExplodedCell(cellId) {
            state.explodedCells.delete(cellId);
            state.selectedHexagons.delete(cellId);
            drawPascalTriangle();
            updateExplodedPanel();
        }
        
        // التراجع عن آخر عملية تفكيك
        function undoExplosion() {
            if (state.history.length > 0) {
                const previousState = state.history.pop();
                state.selectedHexagons = previousState.selectedHexagons;
                state.explodedCells = previousState.explodedCells;
                drawPascalTriangle();
                updateExplodedPanel();
                updateStatusBar("تم التراجع عن آخر عملية تفكيك");
                
                if (state.history.length === 0) {
                    undoButton.disabled = true;
                }
            }
        }
        
        // حساب المعادلات المستخرجة من المثلث
        function calculateFormulas() {
            const formulas = [];
            const triangle = state.triangleData;
            
            // مجموع الصفوف
            for (let i = 0; i < triangle.length; i++) {
                const rowSum = triangle[i].reduce((a, b) => a + b, 0);
                formulas.push({
                    title: `مجموع الصف ${i+1}`,
                    content: `${triangle[i].join(' + ')} = ${rowSum} = 2^${i}`
                });
            }
            
            // أعداد فيبوناتشي
            if (triangle.length >= 5) {
                let fibSequence = [1, 1];
                for (let i = 2; i < triangle.length; i++) {
                    fibSequence.push(fibSequence[i-1] + fibSequence[i-2]);
                }
                formulas.push({
                    title: 'متتالية فيبوناتشي',
                    content: fibSequence.join(', ')
                });
            }
            
            // معاملات ذات الحدين
            if (triangle.length >= 4) {
                const n = triangle.length - 1;
                formulas.push({
                    title: `معاملات (a+b)^${n}`,
                    content: triangle[n].join(', ')
                });
            }
            
            // أعداد مثلثية
            const triangularNumbers = [];
            for (let i = 1; i <= Math.min(5, triangle.length); i++) {
                triangularNumbers.push(triangle[i][1]);
            }
            formulas.push({
                title: 'الأعداد المثلثية',
                content: triangularNumbers.join(', ')
            });
            
            // أعداد مربعة
            const squareNumbers = [];
            for (let i = 0; i < Math.min(5, triangle.length); i++) {
                squareNumbers.push(triangle[i][i] ** 2);
            }
            formulas.push({
                title: 'الأعداد المربعة',
                content: squareNumbers.join(', ')
            });
            
            // عرض المعادلات
            displayFormulas(formulas, formulasContainer);
            
            // تحديث خصائص المثلث
            updateTriangleProperties();
            
            // حساب معادلات العلماء
            calculateScientistsFormulas();
        }
        
        // حساب معادلات العلماء
        function calculateScientistsFormulas() {
            const formulas = [];
            const triangle = state.triangleData;
            
            // نظرية فيثاغورس في المثلث
            if (triangle.length >= 3) {
                formulas.push({
                    title: 'نظرية فيثاغورس العددية',
                    content: `3² + 4² = 5² → ${triangle[2][1]}² + ${triangle[3][1]}² = ${triangle[4][2]}²`
                });
            }
            
            // متطابقة أويلر
            formulas.push({
                title: 'متطابقة أويلر',
                content: 'e^(iπ) + 1 = 0 → العلاقة بين الأعداد الأساسية'
            });
            
            // قانون نيوتن للجاذبية في الأعداد
            if (triangle.length >= 5) {
                formulas.push({
                    title: 'تشابه نيوتن',
                    content: `F = G(m₁m₂/r²) → ${triangle[4][0]}×${triangle[4][2]} = ${triangle[4][0] * triangle[4][2]}`
                });
            }
            
            // تسلسل فيبوناتشي الذهبي
            if (triangle.length >= 7) {
                const goldenRatio = (1 + Math.sqrt(5)) / 2;
                formulas.push({
                    title: 'النسبة الذهبية (فيبوناتشي)',
                    content: `φ ≈ ${goldenRatio.toFixed(4)} → ${triangle[5][2]}/${triangle[4][2]} = ${(triangle[5][2]/triangle[4][2]).toFixed(4)}`
                });
            }
            
            // قانون احتمالات باسكال
            if (triangle.length >= 4) {
                formulas.push({
                    title: 'قانون باسكال للاحتمالات',
                    content: `P = n!/(k!(n-k)!) → ${triangle[3][1]} = 3!/(1!2!)`
                });
            }
            
            // معادلة أرخميدس للدوائر
            formulas.push({
                title: 'تقريب أرخميدس للدائرة',
                content: 'π ≈ 22/7 = 3.142857 → العلاقة بين المحيط والقطر'
            });
            
            // عرض معادلات العلماء
            displayFormulas(formulas, scientistsFormulasContainer);
        }
        
        // عرض المعادلات في الواجهة
        function displayFormulas(formulas, container) {
            container.innerHTML = '';
            
            formulas.forEach(formula => {
                const formulaCard = document.createElement('div');
                formulaCard.className = 'formula-card';
                
                const title = document.createElement('div');
                title.className = 'formula-title';
                title.textContent = formula.title;
                
                const content = document.createElement('div');
                content.className = 'formula-content';
                content.textContent = formula.content;
                
                formulaCard.appendChild(title);
                formulaCard.appendChild(content);
                container.appendChild(formulaCard);
            });
        }
        
        // تحديث خصائص المثلث المعروضة
        function updateTriangleProperties() {
            const triangle = state.triangleData;
            const totalNumbers = triangle.flat().length;
            const maxNumber = Math.max(...triangle.flat());
            const sumAllNumbers = triangle.flat().reduce((a, b) => a + b, 0);
            
            triangleProperties.innerHTML = `
                <p>عدد الطبقات: ${state.layers}</p>
                <p>إجمالي الأعداد: ${totalNumbers}</p>
                <p>أكبر عدد: ${maxNumber}</p>
                <p>مجموع جميع الأعداد: ${sumAllNumbers}</p>
                <p>درجة التدوير: ${state.rotation}°</p>
                <p>مستوى التكبير: ${state.zoom.toFixed(1)}</p>
                <p>الخلايا المحددة: ${state.selectedHexagons.size}</p>
                <p>الخلايا المفككة: ${state.explodedCells.size}</p>
                <p>نوع البيانات: ${getDataTypeName(state.dataType)}</p>
            `;
        }
        
        // الحصول على اسم نوع البيانات
        function getDataTypeName(type) {
            const names = {
                'numbers': 'أرقام باسكال',
                'suras': 'السور القرآنية',
                'allahNames': 'أسماء الله الحسنى',
                'prophets': 'الرسل والأنبياء',
                'pharaohs': 'الفراعنة',
                'abjad': 'حساب الجمل'
            };
            return names[type] || type;
        }
        
        // تحديث شريط الحالة
        function updateStatusBar(message) {
            statusBar.textContent = message;
        }
        
        // تطبيق نظام الألوان
        function applyColorScheme(scheme) {
            state.colorScheme = scheme;
            const colors = colorSchemesMap[scheme];
            
            document.documentElement.style.setProperty('--primary-color', colors.primary);
            document.documentElement.style.setProperty('--secondary-color', colors.secondary);
            document.documentElement.style.setProperty('--accent-color', colors.accent);
            document.documentElement.style.setProperty('--text-color', colors.text);
            document.documentElement.style.setProperty('--background-color', colors.background);
            
            drawPascalTriangle();
        }
        
        // إضافة مستمعي الأحداث
        function setupEventListeners() {
            // تحديث القيم عند تحريك المنزلقات
            layersSlider.addEventListener('input', function() {
                state.layers = parseInt(this.value);
                layersValue.textContent = state.layers;
                drawPascalTriangle();
            });
            
            rotationSlider.addEventListener('input', function() {
                state.rotation = parseInt(this.value);
                rotationValue.textContent = state.rotation;
                drawPascalTriangle();
            });
            
            zoomSlider.addEventListener('input', function() {
                state.zoom = parseFloat(this.value);
                zoomValue.textContent = state.zoom.toFixed(1);
                drawPascalTriangle();
            });
            
            // إعادة ضبط العرض
            resetButton.addEventListener('click', function() {
                state.rotation = 0;
                state.zoom = 1.0;
                state.offsetX = canvas.parentElement.clientWidth / 2;
                state.offsetY = canvas.parentElement.clientHeight / 2;
                
                rotationSlider.value = state.rotation;
                rotationValue.textContent = state.rotation;
                zoomSlider.value = state.zoom;
                zoomValue.textContent = state.zoom.toFixed(1);
                
                drawPascalTriangle();
                updateStatusBar("تم إعادة ضبط العرض");
            });
            
            // إعادة تعيين المثلث
            resetTriangleButton.addEventListener('click', function() {
                state.selectedHexagons.clear();
                state.explodedCells.clear();
                state.history = [];
                undoButton.disabled = true;
                drawPascalTriangle();
                updateExplodedPanel();
                updateStatusBar("تم إعادة تعيين المثلث");
            });
            
            // حساب المعادلات
            calculateButton.addEventListener('click', calculateFormulas);
            
            // التراجع
            undoButton.addEventListener('click', undoExplosion);
            
            // التبويبات
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // إزالة النشاط من جميع التبويبات
                    tabs.forEach(t => t.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));
                    
                    // إضافة النشاط للتبويب المحدد
                    this.classList.add('active');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
            
            // أنماط العرض
            displayStyles.forEach(style => {
                style.addEventListener('click', function() {
                    displayStyles.forEach(s => s.classList.remove('active'));
                    this.classList.add('active');
                    state.displayStyle = this.getAttribute('data-style');
                    drawPascalTriangle();
                    updateStatusBar(`تم تغيير نمط العرض إلى: ${this.textContent}`);
                });
            });
            
            // أنواع البيانات
            dataTypes.forEach(type => {
                type.addEventListener('click', function() {
                    dataTypes.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    state.dataType = this.getAttribute('data-type');
                    drawPascalTriangle();
                    updateStatusBar(`تم تغيير نوع البيانات إلى: ${this.textContent}`);
                });
            });
            
            // أنظمة الألوان
            colorSchemes.forEach(scheme => {
                scheme.addEventListener('click', function() {
                    colorSchemes.forEach(s => s.classList.remove('active'));
                    this.classList.add('active');
                    applyColorScheme(this.getAttribute('data-scheme'));
                    updateStatusBar(`تم تغيير نظام الألوان`);
                });
            });
            
            // تفاعل السحب للتحريك
            canvas.addEventListener('mousedown', function(e) {
                if (e.button === 0 && !state.ctrlPressed) { // زر الماوس الأيسر بدون Ctrl
                    state.isDragging = true;
                    state.lastX = e.clientX;
                    state.lastY = e.clientY;
                    updateStatusBar("جارٍ تحريك العرض - اسحب لتحريك المثلث");
                }
            });
            
            canvas.addEventListener('mousemove', function(e) {
                if (state.isDragging) {
                    const deltaX = e.clientX - state.lastX;
                    const deltaY = e.clientY - state.lastY;
                    
                    state.offsetX += deltaX;
                    state.offsetY += deltaY;
                    
                    state.lastX = e.clientX;
                    state.lastY = e.clientY;
                    
                    drawPascalTriangle();
                }
            });
            
            canvas.addEventListener('mouseup', function(e) {
                if (e.button === 0) {
                    state.isDragging = false;
                }
            });
            
            canvas.addEventListener('mouseleave', function() {
                state.isDragging = false;
            });
            
            // النقر لتفكيك المثلث (Ctrl + زر الماوس الأيسر)
            canvas.addEventListener('click', function(e) {
                if (state.ctrlPressed) {
                    const rect = canvas.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    
                    const cell = getCellFromMouse(x, y);
                    if (cell) {
                        explodeTriangle(cell.row, cell.col);
                    }
                }
            });
            
            // التراجع بزر الماوس الأيمن
            canvas.addEventListener('contextmenu', function(e) {
                e.preventDefault();
                undoExplosion();
            });
            
            // التكبير والتصغير بعجلة الماوس
            canvas.addEventListener('wheel', function(e) {
                e.preventDefault();
                
                const zoomFactor = e.deltaY > 0 ? 0.9 : 1.1;
                state.zoom *= zoomFactor;
                
                // تحديد الحدود الدنيا والقصوى للتكبير
                state.zoom = Math.max(0.1, Math.min(3, state.zoom));
                
                zoomSlider.value = state.zoom;
                zoomValue.textContent = state.zoom.toFixed(1);
                
                drawPascalTriangle();
            });
            
            // اكتشاف ضغط مفتاح Ctrl
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Control') {
                    state.ctrlPressed = true;
                    updateStatusBar("وضع التفكيك نشط - انقر على أي مثلث لتفكيكه");
                }
            });
            
            document.addEventListener('keyup', function(e) {
                if (e.key === 'Control') {
                    state.ctrlPressed = false;
                    updateStatusBar("جاهز - اضغط Ctrl + زر الماوس الأيسر لتفكيك المثلثات");
                }
            });
            
            // إعادة ضبط حجم Canvas عند تغيير حجم النافذة
            window.addEventListener('resize', initCanvas);
        }
        
        // تهيئة التطبيق
        function init() {
            initCanvas();
            setupEventListeners();
            calculateFormulas(); // حساب المعادلات الأولية
            updateExplodedPanel(); // تحديث لوحة الخلايا المفككة
        }
        
        // بدء التطبيق
        init();
    </script>
</body>
</html>
